"use strict";(self.webpackChunkinctagram=self.webpackChunkinctagram||[]).push([[6685],{"./src/widgets/CreateNewPassword/ui/CreateNewPassword.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,default:()=>CreateNewPassword_stories});var defineProperty=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/extends.js"),slicedToArray=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/.pnpm/next@14.0.1_@babel+core@7.23.3_react-dom@18.2.0_react@18.2.0_sass@1.69.5/node_modules/next/dist/compiled/react/index.js"),index_esm=__webpack_require__("./node_modules/.pnpm/react-hook-form@7.48.2_react@18.2.0/node_modules/react-hook-form/dist/index.esm.mjs"),authApi=__webpack_require__("./src/shared/api/authApi/index.ts"),shared_const=__webpack_require__("./src/shared/const/index.ts"),helpers=__webpack_require__("./src/shared/lib/helpers/index.ts"),ui=__webpack_require__("./src/shared/ui/index.ts"),hooks=__webpack_require__("./src/shared/lib/hooks/index.ts"),zod=__webpack_require__("./node_modules/.pnpm/@hookform+resolvers@3.3.2_react-hook-form@7.48.2/node_modules/@hookform/resolvers/zod/dist/zod.mjs"),lib=__webpack_require__("./node_modules/.pnpm/zod@3.22.4/node_modules/zod/lib/index.mjs"),createNewPasswordSchema=function createNewPasswordSchema(transcription){return lib.z.object({password:lib.z.string().min(6,{message:transcription.minLength6}).max(20,{message:transcription.maxLength20}).regex(shared_const.mS,transcription.passwordVerification).trim(),passwordConfirmation:lib.z.string().trim()}).refine((function(_ref){return _ref.password===_ref.passwordConfirmation}),{message:transcription.passwordMismatch,path:["passwordConfirmation"]})},clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.0.0/node_modules/clsx/dist/clsx.mjs"),next_router=__webpack_require__("./node_modules/.pnpm/next@14.0.1_@babel+core@7.23.3_react-dom@18.2.0_react@18.2.0_sass@1.69.5/node_modules/next/router.js"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.3_webpack@5.89.0/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),CreateNewPassword_module=__webpack_require__("./node_modules/.pnpm/css-loader@6.8.1_webpack@5.89.0/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/.pnpm/postcss-loader@7.3.3_postcss@8.4.31_typescript@5.0.2_webpack@5.89.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/resolve-url-loader@5.0.0/node_modules/resolve-url-loader/index.js!./node_modules/.pnpm/sass-loader@12.6.0_sass@1.69.5_webpack@5.89.0/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/widgets/CreateNewPassword/ui/CreateNewPassword.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(CreateNewPassword_module.Z,options);const ui_CreateNewPassword_module=CreateNewPassword_module.Z&&CreateNewPassword_module.Z.locals?CreateNewPassword_module.Z.locals:void 0;var __jsx=react.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var _Default$parameters,_Default$parameters2,CreateNewPassword=function CreateNewPassword(_ref){var code=_ref.code,setRecoveryErrorHandler=_ref.setRecoveryErrorHandler,_useCreateNewPassword=function useCreateNewPassword(){var text=(0,hooks.$G)().text,_useForm=(0,index_esm.cI)({defaultValues:{password:"",passwordConfirmation:""},mode:"onTouched",resolver:(0,zod.F)(createNewPasswordSchema(text.validation))}),control=_useForm.control,isValid=_useForm.formState.isValid;return{control,handleSubmit:_useForm.handleSubmit,isDisabled:!isValid,setError:_useForm.setError,text:text.pages.createNewPassword}}(),control=_useCreateNewPassword.control,handleSubmit=_useCreateNewPassword.handleSubmit,isDisabled=_useCreateNewPassword.isDisabled,setError=_useCreateNewPassword.setError,text=_useCreateNewPassword.text,router=(0,next_router.useRouter)(),_useCreateNewPassword2=(0,authApi.VN)(),creatNewPassword=(0,slicedToArray.Z)(_useCreateNewPassword2,1)[0];return __jsx(ui.Zb,{className:(0,clsx.Z)(ui_CreateNewPassword_module.createNewPassword)},__jsx(ui.ZT,{as:"h1",className:ui_CreateNewPassword_module.title,variant:"h1"},text.title),__jsx("form",{className:ui_CreateNewPassword_module.createNewPasswordForm,onSubmit:handleSubmit((function createNewPasswordHandler(data){creatNewPassword(_objectSpread(_objectSpread({},data),{},{recoveryCode:code})).unwrap().then((function(){return router.push(shared_const.iJ.SIGN_IN)})).catch((function(error){(0,helpers.fn)(error)&&(Array.isArray(error.data.message)&&(error.data.message.find((function(el){return"recoveryCode"===el.field}))?setRecoveryErrorHandler(!0):(0,helpers.gX)(error,setError)))}))}))},__jsx(index_esm.Qr,{control,name:"password",render:function render(_ref2){var field=_ref2.field,error=_ref2.fieldState.error;return __jsx(ui.II,(0,esm_extends.Z)({type:"password"},field,{error:null==error?void 0:error.message,label:text.newPasswordLabel}))}}),__jsx(index_esm.Qr,{control,name:"passwordConfirmation",render:function render(_ref3){var field=_ref3.field,error=_ref3.fieldState.error;return __jsx(ui.II,(0,esm_extends.Z)({type:"password"},field,{error:null==error?void 0:error.message,label:text.newPasswordLabelConfirmation}))}}),__jsx(ui.ZT,{className:ui_CreateNewPassword_module.prompt,variant:"regularText14"},text.prompt),__jsx(ui.zx,{disabled:isDisabled,type:"submit"},text.createNewPasswordBtn)))};CreateNewPassword.displayName="CreateNewPassword",CreateNewPassword.__docgenInfo={description:"",methods:[],displayName:"CreateNewPassword",props:{code:{required:!0,tsType:{name:"string"},description:""},setRecoveryErrorHandler:{required:!0,tsType:{name:"signature",type:"function",raw:"(isError: boolean) => void",signature:{arguments:[{name:"isError",type:{name:"boolean"}}],return:{name:"void"}}},description:""}}};try{CreateNewPassword.displayName="CreateNewPassword",CreateNewPassword.__docgenInfo={description:"",displayName:"CreateNewPassword",props:{code:{defaultValue:null,description:"",name:"code",required:!0,type:{name:"string"}},setRecoveryErrorHandler:{defaultValue:null,description:"",name:"setRecoveryErrorHandler",required:!0,type:{name:"(isError: boolean) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/widgets/CreateNewPassword/ui/CreateNewPassword.tsx#CreateNewPassword"]={docgenInfo:CreateNewPassword.__docgenInfo,name:"CreateNewPassword",path:"src/widgets/CreateNewPassword/ui/CreateNewPassword.tsx#CreateNewPassword"})}catch(__react_docgen_typescript_loader_error){}function CreateNewPassword_stories_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function CreateNewPassword_stories_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CreateNewPassword_stories_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CreateNewPassword_stories_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const CreateNewPassword_stories={component:CreateNewPassword,tags:["autodocs"],title:"Widgets/CreateNewPassword"};var Default={args:{code:"123"}};Default.parameters=CreateNewPassword_stories_objectSpread(CreateNewPassword_stories_objectSpread({},Default.parameters),{},{docs:CreateNewPassword_stories_objectSpread(CreateNewPassword_stories_objectSpread({},null===(_Default$parameters=Default.parameters)||void 0===_Default$parameters?void 0:_Default$parameters.docs),{},{source:CreateNewPassword_stories_objectSpread({originalSource:"{\n  args: {\n    code: '123'\n  }\n}"},null===(_Default$parameters2=Default.parameters)||void 0===_Default$parameters2||null===(_Default$parameters2=_Default$parameters2.docs)||void 0===_Default$parameters2?void 0:_Default$parameters2.source)})})},"./src/shared/api/authApi/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{VN:()=>useCreateNewPasswordMutation,_y:()=>useLogoutMutation,SA:()=>usePasswordRecoveryMutation,uf:()=>useSignInMutation,OE:()=>useSignUpMutation});var asyncToGenerator=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),baseApi=__webpack_require__("./src/shared/api/baseApi/index.ts"),profileApi=__webpack_require__("./src/shared/api/profileApi/index.ts"),shared_const=__webpack_require__("./src/shared/const/index.ts"),helpers=__webpack_require__("./src/shared/lib/helpers/index.ts"),authApi=baseApi.u.injectEndpoints({endpoints:function endpoints(builder){return{createNewPassword:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/new-password"}}}),emailConfirmation:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/registration-confirmation"}}}),emailResending:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/registration-email-resending"}}}),loginByGoogle:builder.query({query:function query(_ref){return{method:"GET",params:{code:_ref.code},url:"auth/google"}}}),logout:builder.mutation({invalidatesTags:["Me"],onQueryStarted:function onQueryStarted(_,_ref2){return(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var dispatch,queryFulfilled,patchResult;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return dispatch=_ref2.dispatch,queryFulfilled=_ref2.queryFulfilled,patchResult=dispatch(profileApi.c_.util.updateQueryData("me",void 0,(function(){return null}))),localStorage.removeItem("accessToken"),_context.prev=3,_context.next=6,queryFulfilled;case 6:_context.next=11;break;case 8:_context.prev=8,_context.t0=_context.catch(3),patchResult.undo();case 11:case"end":return _context.stop()}}),_callee,null,[[3,8]])})))()},query:function query(){return{method:"POST",url:"/auth/logout"}}}),passwordRecovery:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/password-recovery"}}}),passwordRecoveryResending:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/password-recovery-resending"}}}),signIn:builder.mutation({invalidatesTags:["Me"],onQueryStarted:function onQueryStarted(_,_ref3){return(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var queryFulfilled,_yield$queryFulfilled,data;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return queryFulfilled=_ref3.queryFulfilled,_context2.prev=1,_context2.next=4,queryFulfilled;case 4:_yield$queryFulfilled=_context2.sent,data=_yield$queryFulfilled.data,(0,helpers.m8)(shared_const.LA,data.accessToken),_context2.next=12;break;case 9:_context2.prev=9,_context2.t0=_context2.catch(1),localStorage.removeItem(shared_const.LA);case 12:case"end":return _context2.stop()}}),_callee2,null,[[1,9]])})))()},query:function query(body){return{body,method:"POST",url:"/auth/login"}}}),signUp:builder.mutation({query:function query(body){return{body,method:"POST",url:"/auth/registration"}}})}}}),useCreateNewPasswordMutation=authApi.useCreateNewPasswordMutation,useLogoutMutation=(authApi.useEmailConfirmationMutation,authApi.useEmailResendingMutation,authApi.useLoginByGoogleQuery,authApi.useLogoutMutation),usePasswordRecoveryMutation=authApi.usePasswordRecoveryMutation,useSignInMutation=(authApi.usePasswordRecoveryResendingMutation,authApi.useSignInMutation),useSignUpMutation=authApi.useSignUpMutation},"./node_modules/.pnpm/css-loader@6.8.1_webpack@5.89.0/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/.pnpm/postcss-loader@7.3.3_postcss@8.4.31_typescript@5.0.2_webpack@5.89.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/resolve-url-loader@5.0.0/node_modules/resolve-url-loader/index.js!./node_modules/.pnpm/sass-loader@12.6.0_sass@1.69.5_webpack@5.89.0/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/widgets/CreateNewPassword/ui/CreateNewPassword.module.scss":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/css-loader@6.8.1_webpack@5.89.0/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/css-loader@6.8.1_webpack@5.89.0/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_6_8_1_webpack_5_89_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".CreateNewPassword_createNewPassword__Hkmpx{display:flex;flex-direction:column;gap:37px;align-items:center;justify-content:center;width:100%;max-width:378px;padding:24px}.CreateNewPassword_createNewPassword__Hkmpx .CreateNewPassword_createNewPasswordForm__nG_4J{display:flex;flex-direction:column;gap:24px}.CreateNewPassword_passwordError__o7jK3{color:var(--color-danger-500)}.CreateNewPassword_prompt__Jz7nF{color:var(--color-light-900)}","",{version:3,sources:["webpack://./src/widgets/CreateNewPassword/ui/CreateNewPassword.module.scss"],names:[],mappings:"AAAA,4CACE,YAAA,CACA,qBAAA,CACA,QAAA,CACA,kBAAA,CACA,sBAAA,CAEA,UAAA,CACA,eAAA,CACA,YAAA,CAEA,4FACE,YAAA,CACA,qBAAA,CACA,QAAA,CAIJ,wCACE,6BAAA,CAGF,iCACE,4BAAA",sourcesContent:[".createNewPassword {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 37px;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  width: 100%;\r\n  max-width: 378px;\r\n  padding: 24px;\r\n\r\n  .createNewPasswordForm {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 24px;\r\n  }\r\n}\r\n\r\n.passwordError {\r\n  color: var(--color-danger-500);\r\n}\r\n\r\n.prompt {\r\n  color: var(--color-light-900);\r\n}\r\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={createNewPassword:"CreateNewPassword_createNewPassword__Hkmpx",createNewPasswordForm:"CreateNewPassword_createNewPasswordForm__nG_4J",passwordError:"CreateNewPassword_passwordError__o7jK3",prompt:"CreateNewPassword_prompt__Jz7nF"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);